"""
ะะฐะฑะพัะธะน ะฟัะธะผะตั MCP ะฐะณะตะฝัะฐ ะฑะตะท ัะตะฐะปัะฝัั API ะบะปััะตะน
ะะตะผะพะฝัััะธััะตั ะฟัะฐะฒะธะปัะฝัั ะธะฝัะตะณัะฐัะธั MCP ัะตัะฒะตัะพะฒ ั ะฐะณะตะฝัะพะผ
"""

from mcp import StdioServerParameters, stdio_client
from strands import Agent
# from strands.models import AnthropicModel  # ะะต ะดะพัััะฟะตะฝ ะฒ ัะตะบััะตะน ะฒะตััะธะธ
from strands.tools.mcp import MCPClient
import os

def create_mock_agent():
    """ะกะพะทะดะฐะตั ะฐะณะตะฝัะฐ ั mock ะผะพะดะตะปัั ะดะปั ะดะตะผะพะฝัััะฐัะธะธ"""
    
    print("๐ง ะะฐัััะพะนะบะฐ MCP ะบะปะธะตะฝัะพะฒ...")
    
    # AWS Documentation ะบะปะธะตะฝั
    aws_docs_client = MCPClient(
        lambda: stdio_client(
            StdioServerParameters(
                command="uvx", args=["awslabs.aws-documentation-mcp-server@latest"]
            )
        )
    )
    
    # AWS Diagram ะบะปะธะตะฝั
    aws_diag_client = MCPClient(
        lambda: stdio_client(
            StdioServerParameters(
                command="uvx",
                args=[
                    "--with",
                    "sarif-om,jschema_to_python",
                    "awslabs.aws-diagram-mcp-server@latest",
                ],
            )
        )
    )
    
    print("โ MCP ะบะปะธะตะฝัั ะฝะฐัััะพะตะฝั")
    
    # ะกะธััะตะผะฝัะน ะฟัะพะผะฟั ะดะปั ะฐะณะตะฝัะฐ
    SYSTEM_PROMPT = """
    ะั ัะบัะฟะตัั AWS Solutions Architect. ะฃ ะฒะฐั ะตััั ะดะพัััะฟ ะบ:
    
    ๐ ะะพะบัะผะตะฝัะฐัะธะธ AWS:
    - read_documentation: ัะธัะฐะตั ะบะพะฝะบัะตัะฝัะต ัะฐะทะดะตะปั
    - search_documentation: ะธัะตั ะธะฝัะพัะผะฐัะธั
    - recommend: ะดะฐะตั ัะตะบะพะผะตะฝะดะฐัะธะธ
    
    ๐จ ะะฝััััะผะตะฝัะฐะผ ะดะธะฐะณัะฐะผะผ:
    - generate_diagram: ัะพะทะดะฐะตั ะดะธะฐะณัะฐะผะผั ะฐััะธัะตะบัััั
    - get_diagram_examples: ะฟะพะบะฐะทัะฒะฐะตั ะฟัะธะผะตัั
    - list_icons: ะฟะพะบะฐะทัะฒะฐะตั ะดะพัััะฟะฝัะต ะธะบะพะฝะบะธ
    
    ะะปั ัะพะทะดะฐะฝะธั ะดะธะฐะณัะฐะผะผ ะธัะฟะพะปัะทัะนัะต ะฟัะพััะพะน Python ะบะพะด ะฑะตะท import statements.
    ะกะพััะฐะฝัะนัะต ะดะธะฐะณัะฐะผะผั ะฒ ัะตะบัััั ะฟะฐะฟะบั ั ัะฐััะธัะตะฝะธะตะผ .png
    """
    
    try:
        with aws_diag_client, aws_docs_client:
            print("๐ ะะพะดะบะปััะตะฝะธะต ะบ MCP ัะตัะฒะตัะฐะผ...")
            
            # ะะพะปััะฐะตะผ ะฒัะต ะดะพัััะฟะฝัะต ะธะฝััััะผะตะฝัั
            all_tools = aws_diag_client.list_tools_sync() + aws_docs_client.list_tools_sync()
            
            print(f"๐๏ธ  ะะพัััะฟะฝะพ ะธะฝััััะผะตะฝัะพะฒ: {len(all_tools)}")
            for tool in all_tools:
                print(f"   - {tool.tool_name}")
            
            # ะัะพะฒะตััะตะผ ะฝะฐะปะธัะธะต API ะบะปััะฐ
            if not os.getenv("ANTHROPIC_API_KEY"):
                print("\nโ๏ธ  ANTHROPIC_API_KEY ะฝะต ะฝะฐะนะดะตะฝ")
                print("๐ก ะะปั ะฟะพะปะฝะพะน ัะฐะฑะพัั ัััะฐะฝะพะฒะธัะต:")
                print('   $env:ANTHROPIC_API_KEY="your_key_here"')
                print("\n๐ ะกัััะบัััะฐ ะฐะณะตะฝัะฐ ะณะพัะพะฒะฐ, ะธะฝััััะผะตะฝัั ะฟะพะดะบะปััะตะฝั!")
                return None
            
            # ะกะพะทะดะฐะตะผ ะผะพะดะตะปั (AnthropicModel ะฝะต ะดะพัััะฟะตะฝ ะฒ ัะตะบััะตะน ะฒะตััะธะธ)
            print("โ๏ธ  AnthropicModel ะฝะต ะดะพัััะฟะตะฝ ะฒ ัะตะบััะตะน ะฒะตััะธะธ Strands")
            print("๐ก ะัะฟะพะปัะทัะนัะต BedrockModel ั ะฝะฐัััะพะตะฝะฝัะผะธ AWS credentials")
            return None
            
            # ะกะพะทะดะฐะตะผ ะฐะณะตะฝัะฐ
            agent = Agent(
                tools=all_tools,
                model=model,
                system_prompt=SYSTEM_PROMPT
            )
            
            print("๐ค ะะณะตะฝั ัะพะทะดะฐะฝ ััะฟะตัะฝะพ!")
            return agent
            
    except Exception as e:
        print(f"โ ะัะธะฑะบะฐ ะฟัะธ ัะพะทะดะฐะฝะธะธ ะฐะณะตะฝัะฐ: {e}")
        return None

def demonstrate_agent_capabilities():
    """ะะตะผะพะฝัััะธััะตั ะฒะพะทะผะพะถะฝะพััะธ ะฐะณะตะฝัะฐ"""
    
    print("๐ ะะตะผะพะฝัััะฐัะธั AWS MCP ะฐะณะตะฝัะฐ")
    print("=" * 50)
    
    agent = create_mock_agent()
    
    if agent is None:
        print("\n๐ ะงัะพ ะดะตะปะฐะตั ััะพั ะฐะณะตะฝั:")
        print("   1. ๐ ะัะตั ะธะฝัะพัะผะฐัะธั ะฒ ะดะพะบัะผะตะฝัะฐัะธะธ AWS")
        print("   2. ๐ ะงะธัะฐะตั ะบะพะฝะบัะตัะฝัะต ัะฐะทะดะตะปั ะดะพะบัะผะตะฝัะฐัะธะธ")
        print("   3. ๐ก ะะฐะตั ัะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ AWS ัะตัะฒะธัะฐะผ")
        print("   4. ๐จ ะกะพะทะดะฐะตั ะดะธะฐะณัะฐะผะผั ะฐััะธัะตะบัััั")
        print("   5. ๐ ะะพะบะฐะทัะฒะฐะตั ะฟัะธะผะตัั ะดะธะฐะณัะฐะผะผ")
        print("   6. ๐ฏ ะะตัะตัะธัะปัะตั ะดะพัััะฟะฝัะต ะธะบะพะฝะบะธ AWS")
        
        print("\n๐ง ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ:")
        print('   - "ะะฐะนะดะธ ะธะฝัะพัะผะฐัะธั ะพ AWS Lambda"')
        print('   - "ะกะพะทะดะฐะน ะดะธะฐะณัะฐะผะผั ะฒะตะฑ-ะฟัะธะปะพะถะตะฝะธั ั S3 ะธ CloudFront"')
        print('   - "ะะพะบะฐะถะธ ะฟัะธะผะตัั ะฐััะธัะตะบัััะฝัั ะดะธะฐะณัะฐะผะผ"')
        print('   - "ะะฐะบะธะต ะตััั ัะตะบะพะผะตะฝะดะฐัะธะธ ะดะปั serverless ะฐััะธัะตะบัััั?"')
        
        return
    
    # ะัะปะธ ะฐะณะตะฝั ัะพะทะดะฐะฝ, ะผะพะถะฝะพ ะฒัะฟะพะปะฝะธัั ัะตะฐะปัะฝัะต ะทะฐะฟัะพัั
    print("\n๐ฏ ะขะตััะธัะพะฒะฐะฝะธะต ะฐะณะตะฝัะฐ...")
    
    try:
        # ะัะธะผะตั ะทะฐะฟัะพัะฐ ะบ ะฐะณะตะฝัั
        response = agent("ะะพะบะฐะถะธ ะฟัะธะผะตัั ะดะธะฐะณัะฐะผะผ AWS ะฐััะธัะตะบัััั")
        print("โ ะัะฒะตั ะฐะณะตะฝัะฐ:")
        print(response)
        
    except Exception as e:
        print(f"โ๏ธ  ะัะธะฑะบะฐ ะฟัะธ ะฒัะฟะพะปะฝะตะฝะธะธ ะทะฐะฟัะพัะฐ: {e}")

def show_mcp_architecture():
    """ะะพะบะฐะทัะฒะฐะตั ะฐััะธัะตะบัััั MCP ะธะฝัะตะณัะฐัะธะธ"""
    
    print("\n๐๏ธ  ะััะธัะตะบัััะฐ MCP ะธะฝัะตะณัะฐัะธะธ:")
    print("""
    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
    โ   AI Agent      โ    โ   MCP Client     โ    โ   MCP Server    โ
    โ  (Strands)      โโโโโบโ   (Strands)      โโโโโบโ   (AWS Labs)    โ
    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
            โ                        โ                        โ
            โ                        โ                        โ
    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
    โ   Claude Model  โ    โ   stdio_client   โ    โ   uvx runner    โ
    โ  (Anthropic)    โ    โ   (MCP)          โ    โ   (Python)      โ
    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
    """)
    
    print("๐ ะะพัะพะบ ะดะฐะฝะฝัั:")
    print("   1. ะะพะปัะทะพะฒะฐัะตะปั ะพัะฟัะฐะฒะปัะตั ะทะฐะฟัะพั ะฐะณะตะฝัั")
    print("   2. ะะณะตะฝั ะฐะฝะฐะปะธะทะธััะตั ะทะฐะฟัะพั ั ะฟะพะผะพััั Claude")
    print("   3. ะะณะตะฝั ะฒัะทัะฒะฐะตั ะฝัะถะฝัะต MCP ะธะฝััััะผะตะฝัั")
    print("   4. MCP ะบะปะธะตะฝั ะฟะตัะตะดะฐะตั ะทะฐะฟัะพั ัะตัะฒะตัั ัะตัะตะท stdio")
    print("   5. MCP ัะตัะฒะตั ะฒัะฟะพะปะฝัะตั ะดะตะนััะฒะธะต (ะฟะพะธัะบ/ะดะธะฐะณัะฐะผะผะฐ)")
    print("   6. ะะตะทัะปััะฐั ะฒะพะทะฒัะฐัะฐะตััั ะพะฑัะฐัะฝะพ ะบ ะฐะณะตะฝัั")
    print("   7. ะะณะตะฝั ัะพัะผะธััะตั ัะธะฝะฐะปัะฝัะน ะพัะฒะตั ะฟะพะปัะทะพะฒะฐัะตะปั")

def main():
    demonstrate_agent_capabilities()
    show_mcp_architecture()
    
    print("\n" + "=" * 50)
    print("โจ ะะตะผะพะฝัััะฐัะธั ะทะฐะฒะตััะตะฝะฐ!")
    
    print("\n๐ฏ ะกะปะตะดัััะธะต ัะฐะณะธ:")
    print("   1. ะฃััะฐะฝะพะฒะธัะต ANTHROPIC_API_KEY ะดะปั ะฟะพะปะฝะพะน ัะฐะฑะพัั")
    print("   2. ะะปะธ ะฝะฐัััะพะนัะต AWS credentials ะดะปั Bedrock")
    print("   3. ะะฐะฟัััะธัะต ะฐะณะตะฝัะฐ ั ัะตะฐะปัะฝัะผะธ ะทะฐะฟัะพัะฐะผะธ")
    print("   4. ะญะบัะฟะตัะธะผะตะฝัะธััะนัะต ั ัะพะทะดะฐะฝะธะตะผ ะดะธะฐะณัะฐะผะผ")

if __name__ == "__main__":
    main()